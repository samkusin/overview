CMAKE_MINIMUM_REQUIRED(VERSION 2.8)

PROJECT(kazmath)

ENABLE_TESTING()
FIND_PACKAGE(PkgConfig REQUIRED)

SET(CMAKE_C_FLAGS "-std=c99")
ADD_DEFINITIONS("-Wall -g")
#ADD_DEFINITIONS("-DUSE_DOUBLE_PRECISION")

SET(KAZMATH_HEADERS
    ${CMAKE_CURRENT_SOURCE_DIR}/vec2.h
    ${CMAKE_CURRENT_SOURCE_DIR}/vec3.h
    ${CMAKE_CURRENT_SOURCE_DIR}/vec4.h
    ${CMAKE_CURRENT_SOURCE_DIR}/mat4.h
    ${CMAKE_CURRENT_SOURCE_DIR}/mat3.h
    ${CMAKE_CURRENT_SOURCE_DIR}/ray2.h
    ${CMAKE_CURRENT_SOURCE_DIR}/ray3.h
    ${CMAKE_CURRENT_SOURCE_DIR}/plane.h
    ${CMAKE_CURRENT_SOURCE_DIR}/utility.h
    ${CMAKE_CURRENT_SOURCE_DIR}/quaternion.h
    ${CMAKE_CURRENT_SOURCE_DIR}/aabb.h
    ${CMAKE_CURRENT_SOURCE_DIR}/kazmath.h
)

SET(KAZMATH_SOURCES
    ${CMAKE_CURRENT_SOURCE_DIR}/mat4.c
    ${CMAKE_CURRENT_SOURCE_DIR}/mat3.c    
    ${CMAKE_CURRENT_SOURCE_DIR}/plane.c      
    ${CMAKE_CURRENT_SOURCE_DIR}/vec4.c
    ${CMAKE_CURRENT_SOURCE_DIR}/quaternion.c 
    ${CMAKE_CURRENT_SOURCE_DIR}/vec2.c
    ${CMAKE_CURRENT_SOURCE_DIR}/vec3.c
    ${CMAKE_CURRENT_SOURCE_DIR}/utility.c
    ${CMAKE_CURRENT_SOURCE_DIR}/aabb.c
    ${CMAKE_CURRENT_SOURCE_DIR}/ray2.c
    ${CMAKE_CURRENT_SOURCE_DIR}/ray3.c
)

ADD_LIBRARY(kazmath ${KAZMATH_SOURCES})

if( BUILD_SHARED_LIBS )
    FIND_PACKAGE(Threads REQUIRED)
    TARGET_LINK_LIBRARIES(kazmath  ${CMAKE_THREAD_LIBS_INIT})
endif( BUILD_SHARED_LIBS )
SET_TARGET_PROPERTIES(kazmath
                      PROPERTIES
                      VERSION 0.0.1
                      SOVERSION 1)

if( BUILD_SHARED_LIBS )
    INSTALL(TARGETS kazmath LIBRARY DESTINATION lib)
else( BUILD_SHARED_LIBS )
    INSTALL(TARGETS kazmath ARCHIVE DESTINATION lib)
endif( BUILD_SHARED_LIBS )

INSTALL(FILES ${KAZMATH_HEADERS} DESTINATION include/kazmath)

ADD_SUBDIRECTORY(tests)
